<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>QuakePH</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- Leaflet CSS -->
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>

<style>
* { margin:0; padding:0; box-sizing:border-box; }

html, body {
  height:100%;
  background:#0b0f19;
  font-family:Segoe UI, Tahoma, sans-serif;
  color:#e5e7eb;
  overflow:hidden;
}

.app {
  display:flex;
  height:100%;
}

/* ===== SIDEBAR ===== */
.sidebar {
  width:260px;
  background:linear-gradient(180deg,#0b0f19,#111827);
  border-right:1px solid #1f2933;
  padding:16px;
  transition:width .3s;
  position:relative;
}

.sidebar.collapsed { width:70px; }

.toggle {
  position:absolute;
  top:12px;
  right:-15px;
  width:36px;
  height:36px;
  border-radius:50%;
  background:#1f2933;
  border:1px solid #374151;
  color:#93c5fd;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}

.logo {
  text-align:center;
  font-weight:700;
  color:#93c5fd;
  margin-bottom:30px;
  white-space:nowrap;
}

.sidebar.collapsed .logo { opacity:0; }

.nav { list-style:none; }

.nav li {
  padding:14px;
  margin-bottom:12px;
  border-radius:6px;
  cursor:pointer;
  transition:.25s;
  display:flex;
  gap:12px;
}

.nav li span { white-space:nowrap; }

.sidebar.collapsed .nav span { opacity:0; }

.nav li:hover {
  background:rgba(59,130,246,.15);
  transform:translateX(6px);
}

.nav li.active {
  background:rgba(59,130,246,.25);
  font-weight:600;
}

/* ===== MAIN ===== */
.main { flex:1; position:relative; }

iframe, #leafletMap {
  width:100%;
  height:100%;
  border:none;
  display:none;
}

/* ===== PH BUTTON ===== */
.ph-btn {
  position:absolute;
  top:20px;
  right:20px;
  z-index:999;
  background:#1f2933;
  border:1px solid #374151;
  padding:10px 14px;
  color:#93c5fd;
  cursor:pointer;
  border-radius:6px;
}

/* ===== INFO ===== */
#info {
  padding:40px;
  display:none;
}
</style>
</head>

<body>
<div class="app">

<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
  <div class="toggle" id="toggle">‚ò∞</div>
  <div class="logo">QuakePH</div>

  <ul class="nav">
    <li class="active" data-tab="hazard">üåé <span>Global Hazard</span></li>
    <li data-tab="risk">‚ö†Ô∏è <span>Global Risk</span></li>
    <li data-tab="recent">üìç <span>Recent Earthquakes</span></li>
    <li data-tab="about">‚ÑπÔ∏è <span>About</span></li>
  </ul>
</aside>

<!-- MAIN -->
<main class="main">

  <!-- OpenQuake -->
  <iframe id="hazard"
    src="https://maps.openquake.org/map/global-seismic-hazard-map/"
    style="display:block;"></iframe>

  <iframe id="risk"
    src="https://b.maps.openquake.org/map/grm-2023-1/"></iframe>

  <!-- Leaflet -->
  <div id="leafletMap"></div>
  <button class="ph-btn" id="phFocus" style="display:none;">
    üáµüá≠ Focus Philippines
  </button>

  <!-- Info -->
  <div id="info">
    <h1>About QuakePH</h1>
    <p>
      Intelligence-style earthquake dashboard combining global hazard
      models with live USGS earthquake feeds and fault line overlays.
    </p>
  </div>

</main>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>

/* ===== UI ===== */
const sidebar = document.getElementById("sidebar");
document.getElementById("toggle").onclick =
  () => sidebar.classList.toggle("collapsed");

const tabs = document.querySelectorAll(".nav li");
const hazard = document.getElementById("hazard");
const risk = document.getElementById("risk");
const mapDiv = document.getElementById("leafletMap");
const info = document.getElementById("info");
const phBtn = document.getElementById("phFocus");

/* ===== LEAFLET MAP ===== */
const map = L.map("leafletMap").setView([12.5, 121], 5);

L.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png", {
  attribution: "&copy; OpenStreetMap"
}).addTo(map);

/* USGS LIVE FEED (Past Day) */
const quakes = L.geoJSON(null, {
  pointToLayer: (f, latlng) => {
    const m = f.properties.mag;
    return L.circleMarker(latlng, {
      radius: m * 2.5,
      color: "#ef4444",
      fillOpacity: 0.75
    });
  }
}).addTo(map);

fetch("https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson")
  .then(r => r.json())
  .then(d => quakes.addData(d));

/* FAULT LINES (replace with PHIVOLCS if available) */
fetch("https://raw.githubusercontent.com/fraxen/tectonicplates/master/GeoJSON/PB2002_boundaries.json")
  .then(r => r.json())
  .then(d => L.geoJSON(d, {
    style:{ color:"#facc15", weight:1 }
  }).addTo(map));

/* PH Focus */
phBtn.onclick = () => map.setView([12.8797,121.7740],6);

/* ===== NAVIGATION ===== */
tabs.forEach(t => t.onclick = () => {
  tabs.forEach(x => x.classList.remove("active"));
  t.classList.add("active");

  hazard.style.display =
  risk.style.display =
  mapDiv.style.display =
  info.style.display = "none";
  phBtn.style.display = "none";

  if (t.dataset.tab === "hazard") hazard.style.display = "block";
  if (t.dataset.tab === "risk") risk.style.display = "block";
  if (t.dataset.tab === "recent") {
    mapDiv.style.display = "block";
    phBtn.style.display = "block";
    map.invalidateSize();
  }
  if (t.dataset.tab === "about") info.style.display = "block";
});
</script>
</body>
</html>